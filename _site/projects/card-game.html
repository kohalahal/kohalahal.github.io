<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카드 게임</title>
    <style>
        /* 전체 바디 */
        body {
            width:90%;
        }

        h1 {
            background-color: rgb(23, 1, 75);
            color: burlywood;
            text-align: center;
        }
        /* 전체 게임 칸 */
        #game {
            background-color: black;
            width:100%;
            text-align: center;
        }

        /* 카드 칸 */

        #carpet {
            width:90%;
            margin: 0 auto;

        }
        #cards {
            width: 100%;
            
        }
        /* 개별 덱칸 */
        .deck {
            width: 12%;  
            max-width: 100px;         
            align-self: start;
            position: relative;
            display: inline-block;
            margin: 5px;      
            /* border:3px solid yellow;     */
            padding: 3px;
      
        }

        .deck img {            
            width: 100%;             
        }

        .back {
            width: 100%;
            position: absolute;
        }

        #buttons {
            padding: 20Px;
            margin:5px;
        }

        button {
            border: 5px solid #3c73ff;
            background-color: #3c73ff;
            border-radius: 20px;
            color: #fff;
            margin: 5px;

        }
        h2 {
            padding-top: 20px;
            color:cornsilk;
        }


    </style>
</head>
<body>
    <header>
        <h1>카드 게임</h1>
    </header>
    <article>
        <div id="game">
            <h2>두 장씩 뒤집어서 색깔이랑 숫자 똑같으면 끝나는 카드 게임</h2>
            <div id="carpet">

                
            </div>
            <div id="buttons">                
                <button id="btnShow">보이기</button>
                <button id="btnHide">감추기</button> 
                <button id="btnShuffle">섞기/새로하기</button>
            </div>

    </article>
</body>
<script>
    var cardArr = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12",
                "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25",
                "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38",
                "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51"
            ];
    
    //MAX 카드갯수
    var MAX = 52;
    var html="";
    var arr = [];
    var cardsDiv = document.getElementById("carpet");

    var inGame = false;
    var no1 = {};
    var no2 = {};
    //시작시 카드놓음
    window.onload = shuffle;

    function shuffle() {
        cardsDiv.innerHTML='';
        inGame=false;
        cardArr.sort((a,b)=>Math.floor(Math.random()*3-1));
        var div = {};
        for(i=0; i<MAX; i++) {
            if(i%13==0) {
                div = document.createElement("div");
                div.className="cards";
                console.log("div");
            }
            var deck = document.createElement("div");
            deck.className ="deck";
            deck.onclick=function(){flap(this);};

            var back = document.createElement("img");
            var img = document.createElement("img");
            var rand = Math.floor(Math.random()*51);
            back.src = 'blue_back.png';
            back.className = "back";
            img.src = cardArr[i]+".png";
            img.id = cardArr[i];
            img.className = "img";
            deck.appendChild(back);
            deck.appendChild(img);
            div.appendChild(deck);
            cardsDiv.appendChild(div);
            //back.onclick=function(){flip(this);};

        }
    }

    function flap(deck) {
        var back = deck.getElementsByClassName("back");
        if(inGame===false) {
            back[0].setAttribute("style", "opacity:0;");
            inGame=true;
            no1 = deck;
        }
        else if(inGame===true) {
            back[0].setAttribute("style", "opacity:0;");
            no2 = deck;
            compare();
        }
    }

    function compare() {
        var card1 = no1.getElementsByClassName("img")[0];
        var card2 = no2.getElementsByClassName("img")[0];
        if(Math.abs(card1.id-card2.id)===26) {
            

            no1.setAttribute("style","background-color: chartreuse;");
            no2.setAttribute("style","background-color: chartreuse;");
            window.alert("맞았다");
            //card1.setAttribute("style", "position: absolute; width:30%; margin:20%;");
            //card2.setAttribute("style", "position: absolute; width:30%; margin:20%;");
        } else {
            
            setTimeout(function() {
            window.alert("틀렸다");
            console.log("뒤집자");
            no1.getElementsByClassName("back")[0].setAttribute("style", "opacity:1;");
            no2.getElementsByClassName("back")[0].setAttribute("style", "opacity:1;");
            inGame=false;
            }, 500);
           }
            
        
    }

    var showBtn = document.getElementById("btnShow");
    var hideBtn = document.getElementById("btnHide");
    var shuffleBtn = document.getElementById("btnShuffle");
    shuffleBtn.onclick = shuffle;

    showBtn.onclick  = function() {
        var deck = document.getElementsByClassName("deck");
        for(i = 0; i<deck.length; i++) {
            deck[i].getElementsByClassName("back")[0].setAttribute("style","opacity:0;");
        }
    }
    hideBtn.onclick  = function() {
        var deck = document.getElementsByClassName("deck");
        for(i = 0; i<deck.length; i++) {
            deck[i].getElementsByClassName("back")[0].setAttribute("style","opacity:1;");
        }
    }

    

</script>

</html>